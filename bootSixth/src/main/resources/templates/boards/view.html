<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout1}">
<head>

<div layout:fragment="content">
	<div class="panel-heading">View Page</div>
	<div class="panel-body">
		<div class="form-group">
			<label>BNO</label>
			<input class="form-control" name="bno" th:value="${vo.bno}" readonly="readonly"/>
		</div>
		
		<div class="form-group">
			<label>Title</label>
			<input class="form-control" name="title" th:value="${vo.title}" readonly="readonly"/>
			<p class="help-block">Title text here.</p>
		</div>
		
		<div class="form-froup">
			<label>Content</label>
			<textarea class="form-control" rows="3" name='content' th:text="${vo.content}" readonly="readonly"></textarea>
		</div>
		
		<div class="form-group">
			<label>Writer</label>
			<inlut class="form-control" name="writer" th:value="${vo.writer}" readonly="readonly" />
		</div>
		
		<div class="form-group">
			<label>RegDate</label>
			<inlut class="form-control" name="regDate" th:value="${#dates.format(vo.regdate, 'yyyy-MM-dd')}" readonly="readonly"/>
		</div>
	</div>
	
	<div class="pull-right">
		<a th:href="@{modify(page=${pageVO.page}, size=${pageVO.size}, type=${pageVO.type}, keyword=${pageVO.keyword},bno=${vo.bno})}" class='btn btn-default'>Modify/Delete</a>
		<a th:href="@{ list(page=${pageVO.page}, size=${pageVO.size}, type=${pageVO.type}, keyword=${pageVO.keyword}, bno = ${vo.bno} )}" class="btn btn-primary">Go List</a>
	</div>
	<!-- end fragment -->
	
	<div class='container'>
		<table class='table table-striped table-bordered table-hover'>
			<thead>
				<tr>
					<th>RNO</th>
					<th>REPLY TEXT</th>
					<th>REPLER</th>
					<th>REPLY DATE</th>
				</tr>
			</thead>
			<tbody id="replyTable">
			</tbody>
		</table>
	</div>
	
	<th:block layout:fragment="script">
		<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
		<script th:inline="javascript" th:src="@{'/js/reply.js'}"></script>
		<script th:inline="javascript">
			/*$(window).ready(function(){
				var msg = [[${msg}]];
				
				if(msg == 'success'){
					alert('수정되었습니다.');
					var stateObj = {msg: ''};
				}
				replyManager.getAll([[${vo.bno}]], function(list){
					console.log("list..............." + list);
				});
				//console.log(replyManager);
			});*/
			
			$(document).ready(function(e){
				(function(){
					replyManager.getAll([[${vo.bno}]], printList);
				})();
			
				function printList(list){
					var str = "";
					var replyObj;
					for(var i=0; i<list.length; i++){
						replyObj = list[i];
						
						str += 
							'<tr>' +
								'<td>' + replyObj.rno + '</td>' +
								'<td>' + replyObj.replyText + '</td>' +
								'<td>' + replyObj.replyer + '</td>' +
								'<td>' + formatDate(replyObj.regdate) + '</td>' +
							'</tr>';
					}
					$('#replyTable').html(str);
				}
			
				function formatDate(timeValue){
					var date = new Date(timeValue);
					return date.getFullYear() + "-" + (date.getMonth()+1 >= 10 ? date.getMonth()+1 : '0' + (date.getMonth()+1)) + "-" + date.getDate()
				}
			})
		</script>
		
	</th:block>
	
</div>
</html>